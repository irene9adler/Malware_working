# Detecting unknown malicious code by applying classification techniques on OpCode patterns
# 【应用OpCode模式分类技术检测未知恶意代码】
## Abstract
在以前的研究中，分类算法被成功地用于检测未知的恶意代码。大多数使用byte n-gram patterns，本文从文件中提取OpCode n-gram patterns，作为分类使用的特征。分类的目标是从可疑文件中检测未知的恶意代码，后面将作为签名包含在防病毒软件中。测试集30000+文件严格评估，评估文件中不同设置的不同大小表示的OpCode n-gram patterns和八种分类器。这个领域的一个典型问题是现实生活中类别分布不均衡的不平衡问题。 我们调查了不平衡问题，根据几个实际场景，其中恶意文件预计大约占总检查文件的10％。最后，我们提出了一个按照时间顺序进行的评估，其中对更新训练集的频率需求进行了评估。 评估结果表明，评估方法的准确性水平高于96％（TPR大于0.95，FPR大约为0.1），这稍微改善了以前使用字节n-gram表示的研究的结果。按照时间顺序进行的评估显示，随着训练集更新，性能得到明显改善。
##Sec2：background
### 2.1使用Byte N-Grams Patterns检测未知恶意代码
过去20年，位置恶意代码检测的研究集中于基于其二进制代码内容。【16】第一个提出ML方法用于不同恶意代码检测，基于他们的二进制代码。采用了三种不同的特征提取方法：从PE段（Portable Executable Section，便携式可执行部分）提取特征，在程序文件中编码有意义的纯文本字符串，字节序列特征。【13】提出一个框架，使用n-gram+knn检测恶意代码。对于每一个恶意和良性的类，建立一个代表性的profiles。一个新的可执行文件与恶意和良性类的profiles进行比较，并被分配为最相似的。【17】也使用了n-gram特征，但是n-gram特征向量是二进制的，表示文件中是否存在特征，并且忽略特征出现的频率（在文件中）。【18】扩展其工作，将恶意代码分为家族（多分类），基于其各自payload中的函数。为了评估他们根据问题发现日期检测恶意代码的能力，该方法使用2003年7月之前发布的文件进行寻，然后对该时间点到2004年8月发布的文件进行测试。【19】进行了几个实验评估7个特征提取方法，3个分类器，byte n-gram size的结合。近期，【12】使用30000+个文件的测试集，文件表示为byte n-gram，此外还展示了我们后来阐述的对不平衡问题的调查。 在本文中，我们使用OpCode n-gram模式而不是使用byte n-gram模式来呈现可执行文件的替代表示的结果。
### 2.2使用OpCodes表示可执行文件
operational code，操作码，是机器语言指令的一部分，用于指定要执行的操作。一个完整的机器语言指令包含一个操作码和可选的一个或多个操作数的规范。 OpCode的操作可能包括运算，数据操作，逻辑操作和程序控制。
作为机器语言构建块的OpCodes已被用于静态分析应用程序行为和检测恶意软件。【20】提出基于OpCode序列和排列，跟踪恶意软件的演变。【21】使用数据挖掘方法（ANN、逻辑回归、决策树），自动识别可区分恶意和良性程序的关键指令序列。评估准确率高达98.4%。【22】检查恶意代码和非恶意代码中统计操作码频率分布的差异。共有67个恶意软件可执行文件与20个非恶意样本的总体统计数据进行了比较。结果显示，恶意软件OpCode与非恶意软件显著不同，并且表明该方法可用于检测恶意代码。
