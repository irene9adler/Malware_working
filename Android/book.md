# Android软件安全与逆向分析reading总结

## 一、	Sec12 DroidKongFu实例分析
### 1、	先动态分析
用APIMonitor对原始apk做repacked，加入检测点，然后创建AVD虚拟机用emulator运行，在里面安装repacked后的新apk，然后用DDMS中的Droidbox tag监控。
网页版动态分析工具：Mobile Sandbox（现在没找到能用的地方）

问题：APIMonitor 做repacked 脚本运行报错
AVD启动 没有ABI

### 2、	再静态分析
先apktool反汇编看xml，dex2jar看java代码。再IDA Pro分析原生层代码。

P414 naïve核心层分析

## 二、本书做过的工具使用
（1）	起始环境：java eclipse android（studio sdk ndk（ndk是支持naïve原生层））
Android 虚拟机AVD创建

（2）IDA Pro（分析dex文件：dex字节码代码，查找text/API，address定位，导入脚本（解密/格式整理），生成method流程图）

（3）Santoku（移动设备司法取证环境）：androguard超强静态工具

不同脚本实现：

查看apk包、资源、权限、组件、方法等信息。

解密apk包AndroidManifest.xml文件。

生成APK文件中方法的调用流程图。GEXF格式图形文件。（用Gephi查看）

生成dex文件的控制流程和功能调用图。

评估apk文件潜在风险。等。

Androlyze.py shell静态分析：apk dex ->apk对象：apk权限、content provider、broadcast receiver、service。
Dex对象：dex文件中的类、方法、字段信息
等。

（4）APKtool（反编译生成samli文件，dex文件）  
Dex2jar  jd-gui等（dex生成jar文件，看java源码）
C32m（十六进制编辑器，看&改dex文件用）

（5）动态调试
DDMS 的启动、使用、看log。【没做到】
AndBug android调试工具，IDA Pro、gdb调试android原生程序

## 三、知识性的东西

（1）dex文件格式 dex字节码指令集
Dex反汇编成smali工具：BakSmali Dedexer（没有用到）

（2）	smali文件生成和代码（反编译代码）理解。

（3）	ARM汇编知识：为了做原生程序逆向所以介绍。（原生程序编译和逆向分析没怎么看）

（4）	Android app破解和反破解
代码混淆（ProGuard代码混淆工具，混淆、压缩、优化。），混淆类、方法、字段等。

加壳。（Upx，只能加壳win pe）

（5）	android系统
手机ROOT、android权限机制、组件安全、数据安全、ROM安全。

Sec11 android系统攻防 342：

工具 mercury：检查android系统安全漏洞 组建权限提升漏洞。（apk）
1 权限
2 组件： （1）activity：权限攻击  activity劫持程序  （2）Broadcast receiver接收/发送安全  （3）service访问安全  （4）content provider权限
3 数据安全 ：（1）外存：SD存储卡文件读写 （2）内部存储：MODE_PRIVATE 这个内部感觉是指程序内部。
4 数据通信安全：软件之间  软件与server之间  intent数据传输
5 ROM安全：手机固件->闪存
Sec12 一个病毒实例分析 383

