# ck组-18-TIFS：Android Malware Familial Classification and Representative Sample Selection via Frequent Subgraph Analysis
# 通过频繁子图分析 实现 安卓恶意代码家族分类 &代表性样本选择

## 数据集：
4个数据集，都是样本+family。
两个自己构建的：FalDroid-1：1.5w 从virusShare上下的，上传的VT，得到family label。（问题：VT的不同scanner的family label名字不同，结果不同。解决：基于string-edit距离构建family label字典，用过半数的scanner给出的结果做label。）
FalDroid-2：600+43家族。Contagion， massvet ，label的方法同上。
公开的：drebin。5000+样本，132家族。
Genome Project dataset：1000+ 33家族。

## 方法：
（1）预处理：脱壳？
apk文件->apktool反汇编得到dex代码->得到敏感api调用？
敏感API列表：文献22
1构建基础行为模型：用类TF-TDF方法给敏感API加权。
2根据汇编代码生成FCG图，即函数调用图？
3将FCG图简化为SARG图，即敏感API调用图，只留下敏感API节点和父节点。

（2）频繁子图生成
利用共同体检测算法将SARG分成子图集合，将包含敏感API调用的子图作为敏感子图，用子图匹配和聚类技术得到大部分样本有的敏感子图，作为该家族的频繁子图。

（3）特征构建
每个app一个特征向量，用作家族分类任务。
每个家族的频繁子图embedding到特征空间，每个频繁子图有一个权重score表示重要性。
