# 17-TDSC： Detection of Repackaged Android Malware with Code-Heterogeneity Features
利用代码异构特征检测重打包安卓恶意代码
## 摘要：
在重打包时注入恶意代码，改变控制流，保证其执行。
当前分类技术难以检测重打包，因为行为与正常app相似。
文章方法：将代码结构分片成多个基于依赖的区域，每个区域再根据其行为特征分类。
在class级和method级的图中分割代码结构。

## Sec2：定义
Class级的依赖：（1）调用依赖：class C的方法m调用了class C’的方法m’
（2）数据依赖：class C使用了Class C’的变量v’
（3）ICC依赖：class C’通过显式的基于intent的内部组件通信调用class C。

CDG图：class level 依赖图。节点表示类，边表示上述依赖关系，有向图。
DRegion：给定一个app的CDG图，DRegion是其中不相交的类子集，是分割的结果。
Method级的调用依赖：method m调用m’。两个method可以属于相同/不同class，其中一个可以是安卓/java API。
构建method级的调用图是为了提取细节行为特征，以对每个DRegion进行分类，method级调用图包含app内部的调用依赖，以及安卓框架和用户之间的。

## 工作流程：
（1）	IR生成。可以是java字节码，smali代码等。原型实现用的是smali代码。
（2）	CDG和MCG生成：通过分析smali的opcode指令，生成两个图。
（3）	App分割和map：基于CDG图，做可达性分析，将app分成多个DRegions。将MCG中每个method和map到对应的CDG中的class，方法是保存一个字典数据结构。
（4）	生成特征向量：提取DRegion的三类特征。每个DRegion用一个特征向量表示其行为。
（5）	训练和分类：监督学习（问题：DRegion的label哪里来的？）
相似性比较：为了找到打包前的原始app，需要将标为malware的app与其他app比较。

## Sec3：图生成和分割
1、	class级依赖分析
关注安卓event的关系。基于细粒度的method级或变量级的流进行class级依赖关系分析。
