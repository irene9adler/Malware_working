# 14-NDSS  Drebin Effective and Explainable Detection of Android Malware in Your Pocket
# 广泛的静态分析得到大量特征，嵌入联合特征空间。

## 数据集：
共12w+，恶意样本5560。检测率94%。实验对比其他反病毒扫描器。数据集来自2012年8-10月，GooglePlay，和中国、俄罗斯等应用市场。包含了Genome项目的所有malware样本。Label来自VT，10个scanners中至少2个标为恶意的label是恶意。去掉广告软件，因为这个在二分类的灰色区。这个数据集是当时最大规模的安卓恶意代码检测数据集之一。

## 方法：
这篇文章的静态特征提取和分类检测和可解释性提示都是在安卓机上实时做的。

一、	广泛静态分析，从不同源（manifeast，dex字节码）提取静态特征。
先将所有提取出的特征（权限、intents、API调用）用字符串表示，得到8个字符串集合。

Manifest特征集：
AndroidManifest.xml文件，提供数据支持app等安装和运行。

S1：申请的硬件组件，比如摄像头、触摸屏、GPS模块等。

S2：申请的权限。（安卓权限机制），比如发短信申请SEND_SMS权限。

S3：app组件：4种组件 activity，service，content provoders，broadcast receivers。每个app在manifest文件里生命组件类型&名字。将名字也放入特征字符集，可以帮助识别著名的恶意代码组件。

S4：filtered intents：安卓进程内和进程间交流通过intents，将manifest中列出的所有intent作为一个特征集。

反汇编代码的特征集：主要提供app用到的API调用和数据。
（基于dex库的轻量级反汇编，可以输出app中包含的API调用和所有字符串）

S5：限制API调用：安卓权限系统限制对一些关键API的访问，从反汇编代码中找到是否有这些call出现，以得到对函数功能的更深的理解。
另一种特殊的情况是：使用了这些API但没有申请需要的权限，这个说明恶意代码root了手机。

S6：使用了的权限：S5中提取的调用集合可以作为决定申请和实际使用了的权限子集。用了文献15的方法匹配API调用和权限。这个集合从一个更通用的角度反映了app的行为，因为多个API调用可以用一个权限保护。

S7：恶意API调用：访问敏感数据和资源的API。

以下API调用类型：

1访问敏感数据的API

2访问网络通信的API

3 发送接收SMS短信的API

4 运行额外命令的API

5 频繁使用的API 用于混淆（比如加密API）

S8：网络地址集合：恶意代码经常建立网络连接以检索命令或发送从设备中手机的数据。所有反汇编代码中的IP地址，主机名称，URL应放入此集合。一些地址可能在僵尸网络中，因此出现在多个恶意代码样本里，可以帮助提升检测模式。

二、	特征空间嵌入

捕获特征之间的依赖关系。
大多数学习方法在数值向量上操作，需要将提取到的特征映射到向量空间。联合集A取8个特征集合的并集。不同集合的元素可能碰撞，所以每个集合的string前加上这个集合的特定前缀。最终包含50w+的特征。定义|S|维的特征空间，每一位都是0/1，一个app x映射成向量，从x中能提到的特征为1其他的为0。
如何存储高维稀疏特征向量：可以用哈希表/bloom filters。

三、	基于学习的检测

分类器用SVM。

四、	可解释性：

线性SVM的优点：可以看出每个单一特征对决策结果的贡献。在计算f(x)时存储最大的k个权重ws，影响应用到超平面的恶意一侧。提取出k个最重要的特征后，设置一些句子模板对应8个特征集合，用来做用户恶意提醒的说明。
